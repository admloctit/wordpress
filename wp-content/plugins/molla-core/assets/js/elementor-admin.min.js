jQuery(document).ready(function(e){"use strict";function t(t){t.show(),e(".molla-builder-conditional-modal .elementor-templates-modal__header__close i").on("click",function(){t.hide()}),i(e(".ids-select"))}function n(e){return"entire"==e?"all":0===e.indexOf("post")||"category"==e?"post":0===e.indexOf("product")?"product":"page"==e?"page":e.replace(/_archive$|_single$/,"")}function o(t,o,i){var a="",l=void 0!=o&&n(void 0!=i?i:o);if("product_layout"==elementor_admin.builder_type&&(o="single",l="product"),!t&&"product_layout"!=elementor_admin.builder_type){l=o,a+='<div class="condition-wrap condition-category"><select>';return Object.keys(elementor_admin.condition_network).forEach(function(e,t){a+='<option value="'+e+'">'+elementor_admin.condition_network[e].name+"</option>"}),a+="</select></div>"}if(!t&&"product_layout"!=elementor_admin.builder_type||!Object.keys(elementor_admin.condition_network[o].subcats).length)return a;if(void 0==i){a='<div class="condition-wrap condition-subcategory"><select>';return Object.keys(elementor_admin.condition_network[o].subcats).forEach(function(e,t){if("object"==typeof elementor_admin.condition_network[o].subcats[e]){var n=elementor_admin.condition_network[o].subcats[e],i="";i=e[0].toUpperCase()+e.slice(1),"archive"==o&&(i+=elementor_admin.i18n.archive_label),a+="<optgroup label="+i+">",i=Object.keys(n),Object.keys(n).forEach(function(e,t){a+='<option value="'+e+'">'+n[e]+"</option>"}),a+="</optgroup>"}else a+='<option value="'+e+'">'+elementor_admin.condition_network[o].subcats[e]+"</option>"}),a+="</select></div>"}if(i){if(function(e){return-1==e.indexOf("_archive")&&"shop"!=e&&"front"!=e&&"error"!=e}(i)){e(".molla-builder-conditional-modal .condition-subcategory").find('[value="'+i+'"]');a='<div class="condition-wrap condition-ids"><div class="ids-select"><span class="ids-select-toggle" data-id="0"><mark>'+elementor_admin.i18n.all+'</mark></span><div class="dropdown-box"><input type="hidden" name="post_type" value="'+l+'"><input type="hidden" name="taxonomy" value="'+i+'"><input type="search" class="form-control" name="s" required="" autocomplete="off"><div class="live-search-list"></div></div>',a+="</div></div>"}}return a}function i(t){e.fn.devbridgeAutocomplete&&(t=void 0===t?e(".search-wrapper"):t).each(function(){var t=e(this),n=t.find(".live-search-list"),o=t.find('input[name="post_type"]').val(),i=t.find('input[name="taxonomy"]').val(),a=elementor_admin.ajax_url+"?action=molla_template_ids_search&nonce="+elementor_admin.nonce+(o?"&post_type="+o:"")+(i?"&taxonomy="+i:"");t.find('input[type="search"]').each(function(){e(this).siblings(".live-search-list").find(".autocomplete-suggestions").length||(e(this).on("keydown",function(e){"Enter"==e.key&&(t.find(".ids-select-toggle").attr("data-id",0).html("<mark>"+elementor_admin.i18n.all+"</mark>"),t.find(".dropdown-box").removeClass("show"))}),e(this).devbridgeAutocomplete({minChars:3,appendTo:n,triggerSelectOnValidInput:!1,serviceUrl:a,onSearchStart:function(e){},onSelect:function(e){-1!=e.id&&t.find(".ids-select-toggle").attr("data-id",e.id).html("<mark>"+e.title+"</mark>").trigger("click")},onSearchComplete:function(e,t){t.length||n.children().eq(0).hide()},beforeRender:function(t){e(t).removeAttr("style")},formatResult:function(e,t){return'<span class="ids-result" data-id="'+e.id+'">'+e.title+"</span>"}}))})})}elementor.on("frontend:init",function(){var e=elementor.settings.page.model.get("page_css"),t=elementor.settings.page.model.get("page_script");void 0!==e&&setTimeout(function(){elementorFrontend.hooks.doAction("refresh_dynamic_css",e)},1e3),void 0!==t&&setTimeout(function(){elementorFrontend.hooks.doAction("refresh_dynamic_script",t)},1e3);var n=document.getElementById("tmpl-elementor-add-section");n&&(n.textContent=n.textContent.replace('<div class="elementor-add-section-area-button elementor-add-template-button','<div class="elementor-add-section-area-button elementor-studio-section-button" onclick="window.parent.runStudio(this);" title="Molla Studio"><img class="molla-studio-icon" src="https://d-themes.com/wordpress/molla/wp-content/themes/molla/assets/images/logo-studio-mini.png" alt="Molla Studio"><i class="eicon-insert"></i></div><div class="elementor-add-section-area-button elementor-add-template-button'))}),e(document.body).on("input",'textarea[data-setting="page_css"]',function(t){elementorFrontend.hooks.doAction("refresh_dynamic_css",e(this).val())});var a='<li class="condition">'+("popup"==elementor_admin.builder_type?'<div class="condition-wrap condition-input-wrap condition-popup-within"><input type="number" placeholder="'+elementor_admin.i18n.popup_description+'"></div>':"")+("sidebar"==elementor_admin.builder_type?'<div class="condition-wrap condition-sidebar-pos"><select><option value="left">'+elementor_admin.i18n.left+'</option><option value="right">'+elementor_admin.i18n.right+'</option></select></div><div class="condition-wrap condition-input-wrap condition-sidebar-width"><input type="number" placeholder="'+elementor_admin.i18n.width+'"></div>':"")+'<a href="#" class="btn clone_condition" title="'+elementor_admin.i18n.clone_condition+'"><i class="fas fa-copy"></i></a><a href="#" class="btn remove_condition" title="'+elementor_admin.i18n.remove_condition+'"><i class="fas fa-times"></i></a></li>';elementor.on("preview:loaded",function(){var n=elementor.getPanelView().footer.currentView,o=n._behaviors[Object.keys(n.behaviors()).indexOf("saver")];if(-1!=["header","footer","sidebar","popup","product_layout"].indexOf(elementor_admin.builder_type)){var i=elementor.documents.getCurrent().container.settings.get("post_status"),a={className:"elementor-templates-modal molla-builder-conditional-modal",closeButton:!1,draggable:!0,hide:{onOutsideClick:!0,onEscKeyPress:!0}},l=elementor_admin.builder_type.replace("_"," "),d=l[0].toUpperCase()+l.slice(1),s={headerMessage:'<div class="elementor-templates-modal__header"><div class="elementor-templates-modal__header__logo-area"><div class="elementor-templates-modal__header__logo"><span class="elementor-templates-modal__header__logo__icon-wrapper e-logo-wrapper"><i class="eicon-save"></i></span><span class="elementor-templates-modal__header__logo__title">'+elementor_admin.i18n.modal_heading+'</span></div></div><div class="elementor-templates-modal__header__menu-area"></div><div class="elementor-templates-modal__header__items-area"><div class="elementor-templates-modal__header__close elementor-templates-modal__header__close--normal elementor-templates-modal__header__item"><i class="eicon-close" aria-hidden="true" title="Close"></i><span class="elementor-screen-only">Close</span></div><div id="elementor-template-library-header-tools"></div></div></div>',message:'<img src="'+elementor_admin.theme_assets+'/assets/images/retina_logo.png" alt="logo" width="105" ><div class="elementor-template-library-blank-title">'+elementor.translate(elementor_admin.i18n.conditions_title,[d])+'</div><div class="elementor-template-library-blank-message">'+elementor.translate(elementor_admin.i18n.conditions_description,[l])+"</div>"+elementor_admin.conditions};jQuery.extend(!0,a,s);var r=elementorCommon.dialogsManager.createWidget("lightbox",a);r.getElements("message").append(r.addElement("content"),r.addElement("loading")),r.addButton({name:"action",text:elementor_admin.i18n.save_action,callback:function(){!function(){var t=[];e(".molla-builder-conditional-modal .condition").each(function(){var n={};if(n.category=e(this).find(".condition-category select").val(),e(this).find(".condition-subcategory").length&&(n.subcategory=e(this).find(".condition-subcategory select").val(),e(this).find(".condition-ids").length&&(n.id={id:e(this).find(".ids-select-toggle").attr("data-id"),title:e(this).find(".ids-select-toggle").text()})),e(this).find(".condition-popup-within").length&&(n.popup_within=e(this).find(".condition-popup-within input").val()),e(this).find(".condition-sidebar-pos").length){n.sidebar_pos=e(this).find(".condition-sidebar-pos select").val(),n.sidebar_width=e(this).find(".condition-sidebar-width input").val();var o=parseFloat(n.sidebar_width);(o<=0||o>=100)&&e(this).find(".condition-sidebar-width input").val("")}t.push(n)}),e.ajax({url:elementor_admin.ajax_url,type:"post",dataType:"json",data:{action:"molla_save_conditions",nonce:elementor_admin.nonce,conditions:t,post_id:elementor_admin.post_id},success:function(e){"success"==e&&(elementor_admin.builder_conditions=t)}}),e("#elementor-panel-saver-button-publish").trigger("click",["builder_condition_saved"])}()}}),r.getElements("action").addClass("elementor-button elementor-button-success"),n.ui.menuConditions=n.addSubMenuItem("saver-options",{before:"save-template",name:"conditions",icon:"eicon-flow",title:"Display Conditions",callback:function(){t(r)}}),o.ui.buttonPreview.tipsy("disable").html(jQuery("#tmpl-elementor-theme-builder-button-preview").html()).addClass("elementor-panel-footer-theme-builder-buttons-wrapper elementor-toggle-state"),"draft"==i&&(e("#elementor-panel-saver-button-publish").html("publish").removeClass("elementor-disabled"),e("#elementor-panel-saver-button-save-options").removeClass("elementor-disabled"),e("#elementor-panel-saver-button-publish").on("click",function(e,n){void 0===n&&"draft"==elementor.documents.getCurrent().container.settings.get("post_status")&&(e.stopPropagation(),t(r))}))}}),elementor.saver.on("after:save",function(t){"publish"==t.status&&e("#elementor-panel-saver-button-publish").html(elementor.translate("update"))}),e("body").on("click",".molla-builder-conditional-modal .remove_condition",function(t){t.preventDefault(),e(this).closest(".condition").remove()}).on("click",".molla-builder-conditional-modal .clone_condition",function(t){t.preventDefault();var n=e(this).closest(".condition");n.after(e(this).closest(".condition").clone());var o=n.next();o.find(".condition-category select").val(n.find(".condition-category select").val()),o.find(".condition-subcategory select").val(n.find(".condition-subcategory select").val()),i(o.find(".condition-subcategory select").trigger("change"))}).on("click","#molla-add-condition",function(t){e(a).prepend(e(o(!1))).appendTo(e(this).siblings(".conditions")),"product_layout"==elementor_admin.builder_type&&e(".molla-builder-conditional-modal .condition-subcategory select").trigger("change")}).on("change",".molla-builder-conditional-modal .condition-category select",function(){var t=o(!0,e(this).val()),n=e(this).closest(".condition");n.find(".condition-ids").remove(),t?n.find(".condition-subcategory").length?n.find(".condition-subcategory").replaceWith(e(t)):n.find(".condition-category").after(e(t)):n.find(".condition-subcategory, .condition-ids").remove()}).on("change",".molla-builder-conditional-modal .condition-subcategory select",function(){var t=e(this).closest(".condition"),n=o(!0,t.find(".condition-category select").val(),e(this).val());n?(t.find(".condition-ids").length?t.find(".condition-ids").replaceWith(e(n)):t.find(".condition-subcategory").after(e(n)),i(t.find(".ids-select"))):t.find(".condition-ids").remove()}).on("click",".molla-builder-conditional-modal .ids-select-toggle",function(){var t=e(this).siblings(".dropdown-box");t.toggleClass("show"),t.hasClass("show")&&t.children(".form-control").focus()}).on("click",".molla-builder-conditional-modal",function(t){e(this).find(".ids-select .dropdown-box").removeClass("show")}).on("click",".molla-builder-conditional-modal .ids-select",function(e){e.stopPropagation()})});